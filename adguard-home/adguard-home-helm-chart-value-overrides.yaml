apiVersion: v1
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: adguard-home-helm-chart-value-overrides
  namespace: adguard-home
data:
  values.yaml: |-
    image:
      repository: tccr.io/truecharts/adguard-home
      tag: 0.107.25@sha256:90e78953b5e15126b151ac655e37ad161bf5a6f10e2cdbb50da7f68166f57719
      pullPolicy: IfNotPresent

    # Those args are copied from the upstream Dockerfile.
    # Only port was added. So Adguard won't change port after initial setup
    args:
      - --no-check-update
      - --host
      - "0.0.0.0"
      - --config
      - /opt/adguardhome/conf/AdGuardHome.yaml
      - --work-dir
      - /opt/adguardhome/work
      - --port
      - "{{ .Values.service.main.ports.main.port }}"

    securityContext:
      readOnlyRootFilesystem: false
      runAsNonRoot: false

    podSecurityContext:
      runAsUser: 0
      runAsGroup: 0

    probes:
      liveness:
        type: HTTP
        path: /
      readiness:
        type: HTTP
        path: /
      startup:
        type: HTTP
        path: /

    service:
      main:
        enabled: false
        ports:
          main:
            enabled: false
            port: 10232
            protocol: HTTP
      dns-tcp:
        enabled: false
        ports:
          dns-tcp:
            enabled: false
            port: 53
            targetPort: 53
      dns-udp:
        enabled: false
        ports:
          dns-udp:
            enabled: false
            protocol: UDP
            port: 53
            targetPort: 53
      dns-https:
        enabled: false
        ports:
          dns-https:
            enabled: false
            protocol: HTTPS
            port: 10234
            targetPort: 443
      dns-https-udp:
        enabled: false
        ports:
          dns-https-udp:
            enabled: false
            protocol: UDP
            port: 10234
            targetPort: 443
      dns-crypt:
        enabled: false
        ports:
          dns-crypt:
            enabled: false
            protocol: HTTP
            port: 5443
            targetPort: 5443
      dns-crypt-udp:
        enabled: false
        ports:
          dns-crypt-udp:
            enabled: false
            protocol: UDP
            port: 5443
            targetPort: 5443
      dns-quic-udp-1:
        enabled: false
        ports:
          dns-quic-udp-1:
            enabled: false
            protocol: UDP
            port: 784
            targetPort: 784
          dns-quic-udp-2:
            enabled: false
            protocol: UDP
            port: 853
            targetPort: 853
          dns-quic-udp-3:
            enabled: false
            protocol: UDP
            port: 8853
            targetPort: 8853

    persistence:
      config:
        enabled: true
        mountPath: "/opt/adguardhome/conf"
      data:
        enabled: true
        mountPath: "/opt/adguardhome/work"

    portal:
      enabled: true
